# vLLM-FL Dispatch Configuration for METAX (Moore Threads)
# Auto-loaded when running on METAX GPU hardware

# Preferred default backend type: flaggems, vendor, reference
prefer: vendor

# Strict Mode:
#   true  = Raise an error immediately on failure; do not attempt other backends.
#   false = Attempt the next available backend in sequence upon failure (Default).
strict: false

# Vendor Whitelist (Optional, allows all if not set)
# allow_vendors:
#  - metax

# Vendor Blacklist (Optional)
# deny_vendors:
#   - cuda

# Per-operator backend execution order (Optional)
# Only the backends listed here will be attempted, in the order specified.
#
# Supported tokens:
#   - flaggems      : Default FlagGems implementation (Triton)
#   - reference     : PyTorch reference implementation
#   - vendor        : Any available vendor backend (auto-detected)
#   - vendor:metax  : METAX-specific vendor backend
op_backends:
  # Prefer vendor implementation for all operators
  silu_and_mul:
    - vendor
    - flaggems
    - reference

  rms_norm:
    - vendor
    - flaggems
    - reference

  rotary_embedding:
    - vendor
    - flaggems
    - reference

  attention_backend:
    - vendor
    - flaggems

# FlagOS operator blacklist (Optional)
# These operators will not use FlagGems implementation
# flagos_blacklist: []

# OOT operator blacklist (Optional)
# These OOT operators will not be registered
# oot_blacklist: []
